<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>
TIBCO EBX® Documentation - REST Toolkit</title>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type"></meta><meta content="Copyright TIBCO Software Inc. 2001-2021. All rights reserved." name="copyright"></meta><meta content="rest_toolkit_implement" name="doc_id"></meta><link rel="stylesheet" type="text/css" href="../resources/stylesheets/ebx_common.css"></link><link rel="stylesheet" type="text/css" href="../resources/stylesheets/ebx_docPage.css"></link><link rel="stylesheet" type="text/css" href="../resources/syntaxHighlighter/styles/shCoreEclipse.css"></link><link rel="icon" type="image/x-icon" href="../resources/icons/brand.ico"></link></head>
<body class="ebx_simplePage">
<div id="ebx_centerer">
<div id="ebx_main">
<div id="printHeader">
<div class="productName">
TIBCO EBX®</div>
<div class="chapterName">
Documentation &gt; Developer Guide</div>
</div>
<div id="ebx_breadcrumbTop">
<a id="ebx_navigationModeButton" class="ebx_clickableIconLink" href="../index.html?page=rest_toolkit/rest_toolkit_implement.html" title="Display this page with header and navigation panes" target="_top">Navigation mode</a><span class="ebx_breadcrumbLabel">Documentation &gt; Developer Guide</span></div>
<h1>
REST Toolkit</h1>
<div id="toc">
<ul class="toc1">
<li class="toc1"><a href="#id1">Introduction</a></li><li class="toc1"><a href="#applicationDefinitions">Application definitions</a></li><li class="toc1"><a href="#id3">Service and operation definitions</a><ul class="toc2">
<li class="toc2"><a href="#id3s1">URL and sample</a></li></ul>
</li><li class="toc1"><a href="#tableRecordSerialization">Serialization of a table record</a><ul class="toc2">
<li class="toc2"><a href="#id4s1">Built-in serializers</a></li><li class="toc2"><a href="#id4s2">Custom serializers</a></li></ul>
</li><li class="toc1"><a href="#id5">Authentication and lookup mechanism</a></li><li class="toc1"><a href="#authenticationAndPermission">REST authentication and permissions</a></li><li class="toc1"><a href="#uriBuilders">URI builders</a><ul class="toc2">
<li class="toc2"><a href="#id7s1">URI builders for built-in</a></li></ul>
</li><li class="toc1"><a href="#id8">Exception handling</a></li><li class="toc1"><a href="#id9">Monitoring</a></li><li class="toc1"><a href="#id10">Packaging and registration</a></li></ul>
</div>
<h2 id="id1">
Introduction</h2>
<p> TIBCO EBX&reg; offers the possibility to develop custom REST services using the REST Toolkit. The REST Toolkit supports JAX-RS 2.1 (<a href="https://jcp.org/en/jsr/detail?id=370">JSR-370</a>) and JSON-B (<a href="https://jcp.org/en/jsr/detail?id=367">JSR-367</a>). </p><p> A REST service is implemented by a Java class and its operations are implemented by Java methods. The response can be generated by serializing POJO objects. The request input can be unserialized to POJOs. Various input and output formats, including JSON, are supported. For more details on supported formats, see <a href="#serviceMediaTypes">media types</a>. </p><p> Rest Toolkit supports the following: </p><ul>
<li><p>Injectable objects</p><p>EBX&reg; provides injectable objects useful to authenticate the request&#39;s user, to access the EBX&reg; repository or to built URIs without worrying about the configuration (for example <a href="../data_services/restapi_introduction.html#configuration">reverse-proxy</a> or <a href="../user_interface/user_services_implement.html#restDataServices">REST forward</a> modes);</p><p>JAX-RS injectable objects are also supported.</p></li><li><p>Annotations</p><p>EBX&reg; provides annotations to describe resources, grant anonymous access or add restrictions to a method.</p><p>JAX-RS ans JSON-B annotations are also supported.</p></li><li><p>logging and debugging utilities.</p></li></ul>
<div class="ebx_seealso">
<h5>
See also</h5>
<ul>
<li><a href="https://download.oracle.com/otndocs/jcp/servlet-3.0-fr-oth-JSpec">JAX-RS: JavaTM API for RESTful Web Services 2.1</a></li></ul>
</div>
<h2 id="applicationDefinitions">
Application definitions</h2>
<p>An EBX&reg; module, that includes custom REST services, must provide at least one REST Toolkit application class. A REST Toolkit application class extends the EBX&reg; <code><a target="_blank" href="../Java_API/com/orchestranetworks/rest/RESTApplicationAbstract.html"><code>RESTApplicationAbstract</code></a></code> class. The minimum requirement is to define the base URL, using the <code>@ApplicationPath</code> annotation and the set of packages to scan for REST service classes.</p><p>The application path cannot be &quot;<code>/</code>&quot; and must not collide with an existing resource from the module. It is recommended to use &quot;<code>/rest</code>&quot; (the value of constant <code>RESTApplicationAbstract.REST_DEFAULT_APPLICATION_PATH</code>).</p><p> EBX&reg; <code><a target="_blank" href="../Java_API/com/orchestranetworks/rest/annotation/Documentation.html"><code>Documentation</code></a></code> annotation is optional. It is displayed to administrators in &#39;Technical configuration&#39; &gt; &#39;Modules and data models&#39; or when logging and debugging.</p><pre class="brush: java; toolbar: false; gutter: false;">
import javax.ws.rs.*;

import com.orchestranetworks.rest.*;
import com.orchestranetworks.rest.annotation.*;

@ApplicationPath(RESTApplicationAbstract.REST_DEFAULT_APPLICATION_PATH)
@Documentation("My REST sample application")
public final class RESTApplication extends RESTApplicationAbstract
{
   public RESTApplication()
   {
      // Adds one or more package names which will be used to scan for components.
      super((cfg) -> cfg.addPackages(RESTApplication.class.getPackage()));
   }
}</pre>
<h2 id="id3">
Service and operation definitions</h2>
<p>A REST Toolkit service is implemented by a Java class and its operations are implemented by its methods.</p><p> Class and methods can be annotated by <code>@Path</code> to specify the access path. The <code>@Path</code> annotation value defined at the class level will prepend the ones defined on methods. Warning, only one <code>@Path</code> annotation is allowed per class or method.</p><p id="serviceMediaTypes">Media types accepted and produced by a resource are respectively defined by the <code>@Consumes</code> and <code>@Produces</code> JAX-RS annotations. The supported media types are: </p><ul>
<li><p><code>application/json</code> ( <a href="https://javaee.github.io/javaee-spec/javadocs/javax/ws/rs/core/MediaType.html#APPLICATION_JSON_TYPE"> MediaType.APPLICATION_JSON_TYPE </a> ) </p></li><li><p><code>application/octet-stream</code> ( <a href="https://javaee.github.io/javaee-spec/javadocs/javax/ws/rs/core/MediaType.html#APPLICATION_OCTET_STREAM_TYPE"> MediaType.APPLICATION_OCTET_STREAM_TYPE </a> ) </p></li><li><p><code>application/x-www-form-urlencoded</code> ( <a href="https://javaee.github.io/javaee-spec/javadocs/javax/ws/rs/core/MediaType.html#APPLICATION_FORM_URLENCODED_TYPE"> MediaType.APPLICATION_FORM_URLENCODED_TYPE </a> ) </p></li><li><p><code>multipart/form-data</code> ( <a href="https://javaee.github.io/javaee-spec/javadocs/javax/ws/rs/core/MediaType.html#MULTIPART_FORM_DATA_TYPE"> MediaType.MULTIPART_FORM_DATA_TYPE </a> ) </p></li><li><p><code>text/css</code></p></li><li><p><code>text/html</code> ( <a href="https://javaee.github.io/javaee-spec/javadocs/javax/ws/rs/core/MediaType.html#TEXT_HTML_TYPE"> MediaType.TEXT_HTML_TYPE </a> ) </p></li><li><p><code>text/plain</code> ( <a href="https://javaee.github.io/javaee-spec/javadocs/javax/ws/rs/core/MediaType.html#TEXT_PLAIN_TYPE"> MediaType.TEXT_PLAIN_TYPE </a> ) </p></li></ul>
<p> Valid HTTP(S) methods are specified by JAX-RS annotations <code>@GET</code>, <code>@POST</code>, <code>@PUT</code>, etc. Only one of these annotations can be set on each Java method (this means that a Java method can support only one HTTP method). </p><p><strong>Warning</strong>: URL parameters with a name prefixed with <code>ebx-</code> are reserved by REST Toolkit and should not be defined by custom REST services, unless explicitly authorized by the EBX&reg; documentation.</p><h3 id="id3s1">
URL and sample</h3>
<p>The REST URL to access the description service for the sample is defined below:</p><blockquote><p><code>http[s]://&lt;host&gt;[:&lt;port&gt;]/&lt;path to webapp&gt;/rest/track/v1/description</code></p></blockquote><p>Where:</p><ul>
<li><p><code>&lt;path to webapp&gt;</code> corresponds to the web application&#39;s path holding the REST Toolkit application, itself serving the sample service. The path is composed by multiple, or none, URI segments followed by the web application&#39;s name. </p></li></ul>
<div class="ebx_note">
<h5>
Note</h5>
<p>Please note that <code>/rest/track/v1/description</code> corresponds to the concatenation of the service&#39;s <code>@Path</code> annotations.</p></div>
<p>The following REST Toolkit service sample provides methods to query and manage track data:</p><pre class="brush: java; toolbar: false; gutter: false;">
import java.net.*;
import java.util.*;
import java.util.concurrent.*;
import java.util.regex.*;
import java.util.stream.*;

import javax.servlet.http.*;
import javax.ws.rs.*;
import javax.ws.rs.container.*;
import javax.ws.rs.core.*;

import com.orchestranetworks.rest.annotation.*;
import com.orchestranetworks.rest.inject.*;

/**
 * The REST Toolkit Track service v1.
 */
@Produces(MediaType.APPLICATION_JSON)
@Consumes(MediaType.APPLICATION_JSON)
@Path("/track/v1")
@Documentation("Track service")
public final class TrackService
{
	@Context
	private ResourceInfo resourceInfo;

	@Context
	private SessionContext sessionContext;

	private static final Map&lt;Integer, TrackDTO> TRACKS = new ConcurrentHashMap&lt;>();

	/**
	 * Gets service description
	 */
	@GET
	@Path("/description")
	@Documentation("Gets service description")
	@Produces({ MediaType.TEXT_PLAIN, MediaType.APPLICATION_JSON })
	@AnonymousAccessEnabled
	public String handleServiceDescription()
	{
		return this.resourceInfo.getResourceMethod().getAnnotation(Documentation.class).value();
	}

	/**
	 * Selects tracks.
	 */
	@GET
	@Path("/tracks")
	@Documentation("Selects tracks")
	public Collection&lt;TrackDTO> handleSelectTracks(
			@QueryParam("singerFilter") final String singerFilter, // a URL parameter holding a Java regular expression
			@QueryParam("titleFilter") final String titleFilter) // a URL parameter holding a Java regular expression
	{
		final Pattern singerPattern = TrackService.compilePattern(singerFilter);
		final Pattern titlePattern = TrackService.compilePattern(titleFilter);

		return TRACKS.values()
				.parallelStream()
				.filter(Objects::nonNull)
				.filter(track -&gt; singerPattern == null || singerPattern.matcher(track.singer).matches())
				.filter(track -&gt; titlePattern == null || titlePattern.matcher(track.title).matches())
				.collect(Collectors.toList());
	}

	private static Pattern compilePattern(final String aPattern)
	{
		if (aPattern == null || aPattern.isEmpty())
			return null;

		try
		{
			return Pattern.compile(aPattern);
		}
		catch (final PatternSyntaxException ignore)
		{
			// ignore invalid pattern
			return null;
		}
	}

	/**
	 * Counts all tracks.
	 */
	@GET
	@Path("/tracks:count")
	@Documentation("Counts all tracks")
	public int handleCountTracks()
	{
		return TRACKS.size();
	}

	/**
	 * Selects a track by id.
	 */
	@GET
	@Path("/tracks/{id}")
	@Documentation("Selects a track by id")
	public TrackDTO handleSelectTrackById(@PathParam("id") Integer id)
	{
		final TrackDTO track = TRACKS.get(id);
		if (track == null)
			throw new NotFoundException("Track id [" + id + "] does not found.");
		return track;
	}

	/**
	 * Deletes a track by id.
	 */
	@DELETE
	@Path("/tracks/{id}")
	@Documentation("Deletes a track by id")
	public void handleDeleteTrackById(@PathParam("id") Integer id)
	{
		if (!TRACKS.containsKey(id))
			throw new NotFoundException("Track id [" + id + "] does not found.");
		TRACKS.remove(id);
	}

	/**
	 * Inserts or updates one or several tracks.
	 * &lt;p>
	 * The complex response structure corresponds to one of:
	 * &lt;ul>
	 *  &lt;li>An empty content with the &lt;code>location&lt;code> HTTP header defined
	 *   to the access URI.&lt;/li>
	 *  &lt;li>A JSON array of {@link ResultDetailsDTO} objects.&lt;/li>
	 * &lt;/ul>
	 */
	@POST
	@Path("/tracks")
	@Documentation("Inserts or updates one or several tracks")
	public Response handleInsertOrUpdateTracks(List&lt;TrackDTO> tracks)
	{
		int inserted = 0;
		int updated = 0;

		final ResultDetailsDTO[] resultDetails = new ResultDetailsDTO[tracks.size()];
		int resultIndex = 0;

		final URI base = this.sessionContext.getURIInfoUtility()
				.createBuilderForRESTApplication()
				.path(this.getClass())
				.segment("tracks")
				.build();

		for (final TrackDTO track : tracks)
		{
			final String id = String.valueOf(track.id);
			final URI uri = UriBuilder.fromUri(base).segment(id).build();

			final int code;
			if (TRACKS.containsKey(track.id))
			{
				code = HttpServletResponse.SC_NO_CONTENT;
				updated++;
			}
			else
			{
				code = HttpServletResponse.SC_CREATED;
				inserted++;
			}

			TRACKS.put(track.id, track);

			resultDetails[resultIndex++] = ResultDetailsDTO.create(
				code,
				null,
				String.valueOf(track.id),
				uri);
		}

		if (inserted == 1 &amp;&amp; updated == 0)
			return Response.created(resultDetails[0].details).build();

		return Response.ok().entity(resultDetails).build();
	}

	/**
	 * Updates one track.
	 */
	@PUT
	@Path("/tracks/{id}")
	@Documentation("Update one track")
	public void handleUpdateOneTrack(@PathParam("id") Integer id, TrackDTO aTrack)
	{
		final TrackDTO track = TRACKS.get(id);
		if (track == null)
			throw new NotFoundException("Track id [" + id + "] does not found.");

		if (aTrack.id != null &amp;&amp; !aTrack.id.equals(track.id))
			throw new BadRequestException("Selected track id [" + id
				+ "] is not equals to body track id.");

		TRACKS.put(aTrack.id, aTrack);
	}
}</pre>
<p>This REST service uses the following Java classes, which represent a Data Transfer Objects (DTO), to serialize and deserialize data:</p><pre class="brush: java; toolbar: false; gutter: false;">
/**
 * DTO for a track.
 */
public final class TrackDTO
{
	public Integer id;
	public String singer;
	public String title;
}</pre>
<pre class="brush: java; toolbar: false; gutter: false;">
import java.net.*;

/**
 * DTO for result details.
 */
@JsonbPropertyOrder({ "code", "label", "foreignKey", "details" })
public final class ResultDetailsDTO
{
	public int code;
	public String label;
	public String foreignKey;
	public URI details;

	public static ResultDetailsDTO create(
		final int aCode,
		final String aForeignKey,
		final URI aDetails)
	{
		return ResultDetailsDTO.create(aCode, null, aForeignKey, aDetails);
	}

	public static ResultDetailsDTO create(
		final int aCode,
		final String aLabel,
		final String aForeignKey,
		final URI aDetails)
	{
		final ResultDetailsDTO result = new ResultDetailsDTO();
		result.code = aCode;
		result.label = aLabel;
		result.foreignKey = aForeignKey;
		result.details = aDetails;
		return result;
	}
}
</pre>
<h2 id="tableRecordSerialization">
Serialization of a table record</h2>
<h3 id="id4s1">
Built-in serializers</h3>
<p> Default JSON serializers and deserializers are provided to handle table records when declared in DTOs as <a target="_blank" href="../Java_API/com/orchestranetworks/rest/serialization/ContentHolder.html"><code>ContentHolder</code></a>s. Both <a href="../data_services/json_extended.html#recordRequest">extended</a> and <a href="../data_services/json_compact.html#recordRequest">compact</a> JSON formats of record are supported. </p><pre class="brush: java; toolbar: false; gutter: false;">
/**
 * DTO for a singer.
 */
public final class SingerDTO
{
	@Table(
		dataModel = "urn:ebx:module:tracks-module:/WEB-INF/ebx/schemas/tracks.xsd",
		tablePath = "/root/Singers")
	public ContentHolder content;
}</pre>
<p> A same DTO can be used for serialization and deserialization. In case of serialization, a <a target="_blank" href="../Java_API/com/orchestranetworks/rest/serialization/ContentHolderForInput.html"><code>ContentHolderForInput</code></a> instance will be automatically created and filled with the proper data. Afterwards, this instance will be able to copy its data into a <a target="_blank" href="../Java_API/com/orchestranetworks/service/ValueContextForUpdate.html"><code>ValueContextForUpdate</code></a>. To deserialize a table records, a <a target="_blank" href="../Java_API/com/orchestranetworks/rest/serialization/ContentHolderForOutput.html"><code>ContentHolderForOutput</code></a> must be created in the REST operation JAVA method and returned. The provided <a target="_blank" href="../Java_API/com/onwbp/adaptation/Adaptation.html"><code>Adaptation</code></a> data will then be transformed into a valid peace of JSON and placed into the HTTP response body. </p><pre class="brush: java; toolbar: false; gutter: false;">
/**
 * The REST Toolkit Singer service v1.
 */
@Produces(MediaType.APPLICATION_JSON)
@Consumes(MediaType.APPLICATION_JSON)
@Path("/singer/v1")
@Documentation("Singer service")
public final class SingerService
{
	...

	/**
	 * Selects a singer by id.
	 */
	@GET
	@Path("/singers/{id}")
	@Documentation("Selects a singer by id")
	public SingerDTO handleSelectSingerById(final @PathParam("id") Integer id)
	{
		// find the singer adaptation by id
		final Adaptation singerRecord = ... ; 
		
		final SingerDTO singerDTO = new SingerDTO();
		singerDTO.content = ContentHolderForOutput.createForRecord(singerRecord);
		return singerDTO;
	}


	/**
	 * Inserts one singer.
	 */
	@POST
	@Path("/singers")
	@Documentation("Inserts one singer")
	public void handleInsertOneSinger(final SingerDTO aSingerDTO)
	{
		final ProgrammaticService svc = ... ;
		final AdaptationTable singersTable = ... ;
		final ProcedureResult procedureResult = svc.execute(
				(aContext) -> {
					final ValueContextForUpdate createContext = aContext.getContextForNewOccurrence(singersTable); ;
					aSingerDTO.content.asContentHolderForInput().copyTo(createContext);
					aContext.doCreateOccurrence(createContext, singersTable);
				});

		if (procedureResult.hasFailed())
			throw new UnprocessableEntityException(
				procedureResult.getException().getLocalizedMessage());
	}
	
	/**
	 * updates one singer.
	 */
	@PUT
	@Path("/singers/{id}")
	@Documentation("updates one singer")
	public void handleUpdateOneSinger(@PathParam("id") final Integer id, final SingerDTO aSingerDTO)
	{
		final ProgrammaticService svc = ... ;
		final AdaptationTable singersTable = ... ;
		final ProcedureResult procedureResult = svc.execute(
				(aContext) -> {
					// find the singer adaptation by id
					final Adaptation singerRecord = ... ;

					if (singerRecord == null)
						throw new NotFoundException("Singer with the id ["+ id + "] has not been found.");

					final ValueContextForUpdate createContext = aContext.getContext(singerRecord.getAdaptationName()); ;
					aSingerDTO.content.asContentHolderForInput().copyTo(createContext);
					aContext.doModifyContent(singerRecord, createContext);
				});

		if (procedureResult.hasFailed()){
			final Exception ex = procedureResult.getException();
			final Throwable cause = ex.getCause();
			if(cause instanceof NotFoundException)
				throw (NotFoundException) cause;

			throw new UnprocessableEntityException(ex.getLocalizedMessage());
		}	
	}
}</pre>
<p> The default JSON format of the responses, only composed of business data fields, is called <em>compact</em>. </p><pre class="brush: json; toolbar: false; gutter: false;">
{
  "singer":{
  	"firstname":"Frank",
  	"lastname":"Sinatra"
  }
}</pre>
<p> To add technical fields or metadata, the <a target="_blank" href="../Java_API/com/orchestranetworks/rest/annotation/ExtendedOutput.html"><code>ExtendedOutput</code></a> annotation must be placed over the <a target="_blank" href="../Java_API/com/orchestranetworks/rest/serialization/ContentHolder.html"><code>ContentHolder</code></a> field. The annotation must declare every wished options or the <em>ALL</em> one. </p><pre class="brush: java; toolbar: false; gutter: false;">
/**
 * DTO for a singer with technical fields.
 */
public final class SingerWithTechnicalsDTO
{
	@Table(
		dataModel = "urn:ebx:module:tracks-module:/WEB-INF/ebx/schemas/tracks.xsd",
		tablePath = "/root/Singers")
	@ExtendedOutput({Include.LABEL,Include.TECHNICALS,Include.CONTENT})
	public ContentHolder content;
}</pre>
<pre class="brush: json; toolbar: false; gutter: false;">
{
  "singer":{
   	"label": "23",
   	"creationDate": "2018-09-04T15:35:10.706",
    "creationUser": "user",
    "lastUpdateDate": "2018-10-02T17:05:47.090",
    "lastUpdateUser": "user",
  	"content":{
  		"firstname":{
  			"content":"Frank",
  			"label":"First Name"
  		},
  		"lastname":{
  			"content":"Sinatra",
  			"label":"Last Name"
  		}
 	  }
  }
}</pre>
<h3 id="id4s2">
Custom serializers</h3>
<p> Since TIBCO EBX&reg; is based on JSON-B (<a href="https://jcp.org/en/jsr/detail?id=367">JSR-367</a>), custom serializers and deserializers can be defined through <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/bind/annotation/JsonbTypeSerializer.html">JsonbTypeSerializer</a> and <a href="https://javaee.github.io/javaee-spec/javadocs/javax/json/bind/annotation/JsonbTypeDeserializer.html">JsonbTypeDeserializer</a> annotations. </p><pre class="brush: java; toolbar: false; gutter: false;">
/**
 * DTO for a vynil.
 */
public final class VinylDTO
{
	@JsonbTypeSerializer(CustomTrackDtoSerializer.class)
	@JsonbTypeDeserializer(CustomTrackDtoDeserializer.class)
	public TrackDTO track;
}
</pre>
<h2 id="id5">
Authentication and lookup mechanism</h2>
<p>A custom REST service developed with REST Toolkit supports the same authentication methods and lookup mechanism as the built-in REST data services. However, there is a slight difference concerning the &#39;Anonymous authentication Scheme&#39; since its scope can be wider by using the <code><a target="_blank" href="../Java_API/com/orchestranetworks/rest/annotation/AnonymousAccessEnabled.html"><code>AnonymousAccessEnabled</code></a></code>. See <a href="#authenticationAndPermission">REST authentication and permissions</a> for more information. </p><div class="ebx_seealso">
<h5>
See also</h5>
<ul>
<li><a href="../data_services/restapi_introduction.html#authentication">Authentication</a></li><li><a href="../data_services/restapi_introduction.html#lookupMecanism">Lookup mechanism</a></li></ul>
</div>
<h2 id="authenticationAndPermission">
REST authentication and permissions</h2>
<p>By default, every REST resource Java method requires users to be authenticated.</p><p> However, some methods may need to be accessible anonymously. These methods must be annotated by <code><a target="_blank" href="../Java_API/com/orchestranetworks/rest/annotation/AnonymousAccessEnabled.html"><code>AnonymousAccessEnabled</code></a></code>.</p><p>Some methods may need to be restricted to given profiles. These methods may be annotated by <code><a target="_blank" href="../Java_API/com/orchestranetworks/rest/annotation/Authorization.html"><code>Authorization</code></a></code> to specify an authorization rule. An authorization rule is a Java class that implements the <code><a target="_blank" href="../Java_API/com/orchestranetworks/rest/security/AuthorizationRule.html"><code>AuthorizationRule</code></a></code> interface. </p><pre class="brush: java; toolbar: false; gutter: false;">
import javax.ws.rs.*;

import com.orchestranetworks.rest.annotation.*;

/**
 * The REST Toolkit service v1.
 */
@Path("/service/v1")
@Documentation("Service")
public final class Service
{
	...

	/**
	 * Gets service description
	 */
	@GET
	@AnonymousAccessEnabled
	public String handleServiceDescription()
	{
		...
	}

	/**
	 * Gets restricted service
	 */
	@GET
	@Authorization(IsUserAuthorized.class)
	public RestrictedServiceDTO handleRestrictedService()
	{
		...
	}
}</pre>
<h2 id="uriBuilders">
URI builders</h2>
<p>REST Toolkit provides a utility interface <code><a target="_blank" href="../Java_API/com/orchestranetworks/rest/util/URIInfoUtility.html"><code>URIInfoUtility</code></a></code> to generate URIs. An instance of this interface is accessible through the injectable built-in object <code><a target="_blank" href="../Java_API/com/orchestranetworks/rest/inject/SessionContext.html"><code>SessionContext</code></a></code>. </p><h3 id="id7s1">
URI builders for built-in</h3>
<p> Several URI builders interfaces have been designed to ease built-in RESTful services URI build. Each interface constitute an aggregation of methods related to the same functional concept. This division allows development of modular and generic algorithms. Some of these interfaces are themselves aggregation of other ones, leading to intuitive use of the builders since only consistent combination of method calls are allowed. For example, a URI builder configured for the REST <code>hierarchy</code> category will not allow calls to record URI build methods, since record access are part of the REST <code>data</code> category concept. </p><p> See <code><a target="_blank" href="../Java_API/com/orchestranetworks/rest/util/URIBuilderForBuiltin.html"><code>URIBuilderForBuiltin</code></a></code> and <code><a target="_blank" href="../Java_API/com/orchestranetworks/rest/util/CategoryURIBuilder.html"><code>CategoryURIBuilder</code></a></code> for more information. </p><h2 id="id8">
Exception handling</h2>
<p>A REST Toolkit Java method can produce a standard HTTP error response by throwing a Java exception that extends the JAX-RS class <code>javax.ws.rs.WebApplicationException</code>. JAX-RS defines exceptions for various HTTP status codes. EBX&reg; defines <code><a target="_blank" href="../Java_API/com/orchestranetworks/rest/UnprocessableEntityException.html"><code>UnprocessableEntityException</code></a></code> that adds support for the HTTP <code>422</code><em>(Unprocessable entity)</em> code.</p><p> Plain Java exceptions are mapped to the HTTP status code <code>500</code><em> (Internal server error)</em>.</p><pre class="brush: json; toolbar: false; gutter: false;">
{
  "userMessage": "...", // Mandatory localized message
  "errorCode":   "999", // EBX® error code (optional, used mainly for HTTP error 422)
  "errors": [           // Internal messages useful when debugging (optional).
                        // Usually not displayed to the user and not localized.
     "Message 1", "Message 2" }
  ]
}</pre>
<h2 id="id9">
Monitoring</h2>
<p> REST Toolkit events monitoring is similar to the data services log configuration. The difference is the property key which must be <code>ebx.log4j.category.log.restServices</code>. </p><div class="ebx_seealso">
<h5>
See also</h5>
<ul>
<li><a href="../data_services/restapi_introduction.html#monitoring">Monitoring</a></li><li><a href="../installation/properties.html#ebxLog">Configuring the EBX&reg; logs</a></li></ul>
</div>
<p> Some additional properties are available to configure the log messages. See <a href="../installation/properties.html#restServices">Configuring REST toolkit services</a> for further information. </p><h2 id="id10">
Packaging and registration</h2>
<p> All applications and components are required to be packaged into the module&#39;s Web Application (war file). </p><p> The JAX-RS libraries, except the JAX-RS client API, are already included in <code>ebx.jar</code> and must not be packaged in the war file. </p><p> See <a href="../installation/deploy_on_jee.html">Java EE deployment</a> for more information. </p><p> The registration of a REST Toolkit application is integrated into the EBX&reg; module registration process. The registration class must extend <code><a target="_blank" href="../Java_API/com/orchestranetworks/module/ModuleRegistrationListener.html"><code>ModuleRegistrationListener</code></a></code>, declare the Servlet 3.0 annotation <code>@WebListener</code> and override the <code>handleContextInitialized</code> method. </p><p> See <a href="../models/modules_packaging.html#registration">Module registration</a> for more information. </p><pre class="brush: java; toolbar: false; gutter: false;">
import javax.servlet.annotation.*;

import com.orchestranetworks.module.*;

@WebListener
public final class RegistrationModule extends ModuleRegistrationListener
{
	@Override
	public void handleContextInitialized(final ModuleInitializedContext aContext)
	{
		// Registers dynamically a REST Toolkit application.
		aContext.registerRESTApplication(RESTApplication.class);
	}
}
</pre>
<div id="ebx_breadcrumbBottom">
<span class="ebx_breadcrumbLabel">Documentation &gt; Developer Guide</span></div>
</div>
<p id="ebx_footer"><b>TIBCO EBX® Version 6.0.1. </b>Copyright &copy; <a href="https://www.tibco.com" target="_blank" style="text-decoration: none;">TIBCO&nbsp;Software&nbsp;Inc.</a> 2001-2021. All rights reserved.<br></br>All third party product and company names and third party marks mentioned in this document are the property of their respective owners and are mentioned for identification.</p></div>
<script type="text/javaScript" src="../resources/yui/yahoo/yahoo-min.js">
</script>
<script type="text/javaScript" src="../resources/yui/event/event-min.js">
</script>
<script type="text/javaScript" src="../resources/jscripts/ebx_doc_utils.js">
</script>
<script type="text/javaScript" src="../resources/jscripts/ebx_simplePage.js">
</script>
<script type="text/javaScript" src="../resources/syntaxHighlighter/scripts/shCore.js">
</script>
<script type="text/javaScript" src="../resources/syntaxHighlighter/scripts/shBrushBash.js">
</script>
<script type="text/javaScript" src="../resources/syntaxHighlighter/scripts/shBrushCss.js">
</script>
<script type="text/javaScript" src="../resources/syntaxHighlighter/scripts/shBrushDiff.js">
</script>
<script type="text/javaScript" src="../resources/syntaxHighlighter/scripts/shBrushJava.js">
</script>
<script type="text/javaScript" src="../resources/syntaxHighlighter/scripts/shBrushJScript.js">
</script>
<script type="text/javaScript" src="../resources/syntaxHighlighter/scripts/shBrushPlain.js">
</script>
<script type="text/javaScript" src="../resources/syntaxHighlighter/scripts/shBrushProperties.js">
</script>
<script type="text/javaScript" src="../resources/syntaxHighlighter/scripts/shBrushSql.js">
</script>
<script type="text/javaScript" src="../resources/syntaxHighlighter/scripts/shBrushXml.js">
</script>
<script type="text/javaScript">
SyntaxHighlighter.all();</script>
</body>
</html>
